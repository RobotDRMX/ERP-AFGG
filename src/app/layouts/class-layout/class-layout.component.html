<div class="flex min-h-screen overflow-hidden">

    <!-- Sidebar -->
    <aside class="surface-overlay border-r transition-all duration-300"
        style="display: flex; flex-direction: column;"
        [class.sidebar-collapsed-width]="isCollapsed()" [class.sidebar-width]="!isCollapsed()">

        <p-menu [model]="items" styleClass="sidebar-menu border-none w-full">

            <!-- Logo / Header -->
            <ng-template #start>
                <div class="p-4 flex-between border-b">
                    <span class="font-bold text-xl text-color no-wrap" [class.hidden]="isCollapsed()">
                        ClassAccess
                    </span>
                    <p-button icon="pi pi-bars" [text]="true" (onClick)="toggleSidebar()" severity="secondary" />
                </div>
            </ng-template>

            <!-- Sección de grupo (label de sección) -->
            <ng-template #submenuheader let-item>
                <span class="text-xs font-semibold text-muted uppercase" [class.hidden]="isCollapsed()">
                    {{ item.label }}
                </span>
            </ng-template>

            <!-- Cada ítem de navegación con routerLink activo -->
            <ng-template #item let-item>
                <a [routerLink]="item.routerLink" routerLinkActive="active-link"
                    class="p-menuitem-link nav-btn no-underline w-full">
                    <span [class]="item.icon + ' p-menuitem-icon'"></span>
                    <span class="p-menuitem-text" [class.hidden]="isCollapsed()">{{ item.label }}</span>
                </a>
            </ng-template>

            <!-- Footer: versión + cerrar sesión + usuario -->
            <ng-template #end>

                <!-- Versión de la app -->
                <div class="px-4 py-3 border-b flex gap-2" style="align-items: center;">
                    <i class="pi pi-code-branch text-muted"></i>
                    <span class="text-xs text-muted no-wrap" [class.hidden]="isCollapsed()">
                        v{{ appVersion }}
                    </span>
                </div>

                <!-- Cerrar sesión -->
                <div class="p-3 border-b">
                    <button (click)="logout()" class="nav-btn no-underline w-full border-none cursor-pointer"
                        style="background: transparent; text-align: left;">
                        <i class="pi pi-sign-out text-danger"></i>
                        <span [class.hidden]="isCollapsed()" class="text-danger">Cerrar sesión</span>
                    </button>
                </div>

                <!-- Info del usuario -->
                <div class="p-3 flex gap-3" style="align-items: center;">
                    <p-avatar icon="pi pi-user" shape="circle" />
                    <div [class.hidden]="isCollapsed()">
                        <p class="m-0 font-semibold text-sm text-color no-wrap">{{ currentUser()?.name }}</p>
                        <p class="m-0 text-xs text-muted">Admin</p>
                    </div>
                </div>

            </ng-template>

        </p-menu>
    </aside>

    <!-- Contenido principal -->
    <main class="flex-1 overflow-auto p-8">
        <div class="admin-main-max-w">
            <router-outlet />
        </div>
    </main>

</div>
